import os
import csv

CATA = 'Worm'

CSV_DIR_1 = 'G:/API_result_union_tmp/apiseq_'+ CATA +'.csv'
CSV_DIR_2 = 'G:/API_result/apiseq00.csv'
# 将2合并到1中
csv_reader_1 = csv.reader(open(CSV_DIR_1))
csv_reader_2 = csv.reader(open(CSV_DIR_2))

md5_dic = {}

print(type(csv_reader_1))

csv_1 = []
for row in csv_reader_1:
    md5 = row[0]
    # print('md5',md5)
    md5_dic[md5] = True
    csv_1.append(row)


# 去重部分
result = {}
fopen = open('result.json','r')
result_dic = eval(fopen.read())
fopen.close()

tot = 0
for row in csv_reader_2:
    md5 = row[0]
    if md5 in md5_dic:
        print('重复去除')
        continue

    label = result[md5]['label']
    if not label == CATA:
        continue
    print('md5', md5)
    tot = tot + 1

    new_row = row
    new_row[0] = md5
    csv_1.append(new_row)

print('新加入', tot, '个'+ CATA)

csvFile = open('G:/API_result_union/apiseq_'+CATA+ '.csv', 'w',encoding='utf8',newline='')

writer = csv.writer(csvFile)
for i in range(len(csv_1)):
    writer.writerow(csv_1[i])
csvFile.close()








