import os
import hashlib

FILE_DIR = 'G:/02_EXE'
md52name = {}

tot = 0
for root, dirs, files in os.walk(FILE_DIR):
    print(root,dirs,files)
    if len(dirs) == 0:
        for file in files:
            # 过滤临时文件
            if file[0] == '.':
                continue
            f = open(os.path.join(root, file), 'rb')
            md5_obj = hashlib.md5()
            md5_obj.update(f.read())
            hash_code = md5_obj.hexdigest()
            f.close()
            md5 = str(hash_code).lower()
            print(file,md5)
            md52name[md5] = {}
            md52name[md5]['name'] = file
            if file.split('.')[0] == 'Worm':
                tot = tot + 1
            md52name[md5]['dir'] = os.path.join(root, file)
            print(md5, file)

print('共有', tot, '个Worm')
'''
fwrite = open('dic_pku.json', 'w')
fwrite.write(str(md52name))
fwrite.close()
'''
